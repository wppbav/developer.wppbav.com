"use strict";(self.webpackChunkthe_fount=self.webpackChunkthe_fount||[]).push([[6537],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>k});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},d=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),u=p(a),c=r,k=u["".concat(s,".").concat(c)]||u[c]||m[c]||i;return a?n.createElement(k,l(l({ref:t},d),{},{components:a})):n.createElement(k,l({ref:t},d))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=c;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[u]="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},8949:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(7294),r=a(6010);const i={tabItem:"tabItem_Ymn6"};function l(e){let{children:t,hidden:a,className:l}=e;return n.createElement("div",{role:"tabpanel",className:(0,r.Z)(i.tabItem,l),hidden:a},t)}},4866:(e,t,a)=>{a.d(t,{Z:()=>v});var n=a(7462),r=a(7294),i=a(6010),l=a(2466),o=a(6550),s=a(1980),p=a(7392),d=a(12);function u(e){return function(e){return r.Children.map(e,(e=>{if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))}(e).map((e=>{let{props:{value:t,label:a,attributes:n,default:r}}=e;return{value:t,label:a,attributes:n,default:r}}))}function m(e){const{values:t,children:a}=e;return(0,r.useMemo)((()=>{const e=t??u(a);return function(e){const t=(0,p.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,a])}function c(e){let{value:t,tabValues:a}=e;return a.some((e=>e.value===t))}function k(e){let{queryString:t=!1,groupId:a}=e;const n=(0,o.k6)(),i=function(e){let{queryString:t=!1,groupId:a}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:t,groupId:a});return[(0,s._X)(i),(0,r.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(n.location.search);t.set(i,e),n.replace({...n.location,search:t.toString()})}),[i,n])]}function h(e){const{defaultValue:t,queryString:a=!1,groupId:n}=e,i=m(e),[l,o]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!c({value:t,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=a.find((e=>e.default))??a[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:i}))),[s,p]=k({queryString:a,groupId:n}),[u,h]=function(e){let{groupId:t}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(t),[n,i]=(0,d.Nk)(a);return[n,(0,r.useCallback)((e=>{a&&i.set(e)}),[a,i])]}({groupId:n}),g=(()=>{const e=s??u;return c({value:e,tabValues:i})?e:null})();(0,r.useLayoutEffect)((()=>{g&&o(g)}),[g]);return{selectedValue:l,selectValue:(0,r.useCallback)((e=>{if(!c({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);o(e),p(e),h(e)}),[p,h,i]),tabValues:i}}var g=a(2389);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function f(e){let{className:t,block:a,selectedValue:o,selectValue:s,tabValues:p}=e;const d=[],{blockElementScrollPositionUntilNextRender:u}=(0,l.o5)(),m=e=>{const t=e.currentTarget,a=d.indexOf(t),n=p[a].value;n!==o&&(u(t),s(n))},c=e=>{let t=null;switch(e.key){case"Enter":m(e);break;case"ArrowRight":{const a=d.indexOf(e.currentTarget)+1;t=d[a]??d[0];break}case"ArrowLeft":{const a=d.indexOf(e.currentTarget)-1;t=d[a]??d[d.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":a},t)},p.map((e=>{let{value:t,label:a,attributes:l}=e;return r.createElement("li",(0,n.Z)({role:"tab",tabIndex:o===t?0:-1,"aria-selected":o===t,key:t,ref:e=>d.push(e),onKeyDown:c,onClick:m},l,{className:(0,i.Z)("tabs__item",b.tabItem,l?.className,{"tabs__item--active":o===t})}),a??t)})))}function N(e){let{lazy:t,children:a,selectedValue:n}=e;if(a=Array.isArray(a)?a:[a],t){const e=a.find((e=>e.props.value===n));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},a.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==n}))))}function y(e){const t=h(e);return r.createElement("div",{className:(0,i.Z)("tabs-container",b.tabList)},r.createElement(f,(0,n.Z)({},e,t)),r.createElement(N,(0,n.Z)({},e,t)))}function v(e){const t=(0,g.Z)();return r.createElement(y,(0,n.Z)({key:String(t)},e))}},158:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>k,frontMatter:()=>o,metadata:()=>p,toc:()=>u});var n=a(7462),r=(a(7294),a(3905)),i=a(4866),l=a(8949);const o={sidebar_label:"Basic Usage"},s="Basic Usage",p={unversionedId:"developer-tools/python/basic-usage",id:"developer-tools/python/basic-usage",title:"Basic Usage",description:"Once you have installed bavapi and acquired a token from the Fount, you can start using bavapi directly in Python",source:"@site/docs/developer-tools/python/basic-usage.md",sourceDirName:"developer-tools/python",slug:"/developer-tools/python/basic-usage",permalink:"/docs/2.x/developer-tools/python/basic-usage",draft:!1,editUrl:"https://github.com/wppbav/developer.wppbav.com/edit/main/docs/developer-tools/python/basic-usage.md",tags:[],version:"current",frontMatter:{sidebar_label:"Basic Usage"},sidebar:"toolsSidebar",previous:{title:"Reference Classes",permalink:"/docs/2.x/developer-tools/python/reference-classes"},next:{title:"Advanced Usage",permalink:"/docs/2.x/developer-tools/python/advanced-usage"}},d={},u=[{value:"Making Requests",id:"making-requests",level:2},{value:"<code>bavapi</code> query parameters",id:"bavapi-query-parameters",level:2},{value:"Filters",id:"filters",level:3},{value:"Value filters",id:"value-filters",level:3},{value:"Fields",id:"fields",level:3},{value:"Sort",id:"sort",level:3},{value:"Includes",id:"includes",level:3},{value:"Pagination",id:"pagination",level:3},{value:"Metric and metric group keys",id:"metric-and-metric-group-keys",level:3},{value:"Using <code>Query</code> objects",id:"using-query-objects",level:2},{value:"Formatting output",id:"formatting-output",level:2},{value:"Suppressing progress bars",id:"suppressing-progress-bars",level:2},{value:"Timeout",id:"timeout",level:2},{value:"Error handling",id:"error-handling",level:2},{value:"Warn or raise when a page fails to download",id:"warn-or-raise-when-a-page-fails-to-download",level:3},{value:"Retry failed requests",id:"retry-failed-requests",level:3}],m={toc:u},c="wrapper";function k(e){let{components:t,...a}=e;return(0,r.kt)(c,(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"basic-usage"},"Basic Usage"),(0,r.kt)("p",null,"Once you have installed ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," and acquired a token from the Fount, you can start using ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," directly in Python\nor in a Jupyter Notebook."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},"import bavapi\n")),(0,r.kt)("h2",{id:"making-requests"},"Making Requests"),(0,r.kt)("p",null,"You can query the available ",(0,r.kt)("a",{parentName:"p",href:"endpoints/"},"endpoints")," with their corresponding methods. Replace ",(0,r.kt)("inlineCode",{parentName:"p"},"TOKEN")," with\nyour ",(0,r.kt)("a",{parentName:"p",href:"authentication"},"API key"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'swatch = bavapi.brands("TOKEN", name="Swatch")  # Replace `TOKEN` with your API key\n')),(0,r.kt)("p",null,"These endpoints methods will return a pandas DataFrame containing the data retrieved for your query:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"right"}),(0,r.kt)("th",{parentName:"tr",align:"left"},"id"),(0,r.kt)("th",{parentName:"tr",align:"left"},"name"),(0,r.kt)("th",{parentName:"tr",align:"left"},"..."))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"0"),(0,r.kt)("td",{parentName:"tr",align:"left"},"2342"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Swatch"),(0,r.kt)("td",{parentName:"tr",align:"left"},"...")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"1"),(0,r.kt)("td",{parentName:"tr",align:"left"},"127896"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Swatch"),(0,r.kt)("td",{parentName:"tr",align:"left"},"...")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"..."),(0,r.kt)("td",{parentName:"tr",align:"left"},"..."),(0,r.kt)("td",{parentName:"tr",align:"left"},"..."),(0,r.kt)("td",{parentName:"tr",align:"left"},"...")))),(0,r.kt)("p",null,"You can make requests to other ",(0,r.kt)("a",{parentName:"p",href:"endpoints/"},"endpoints")," in the same way:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'uk_studies = bavapi.studies("TOKEN", country_code="GB")\n\nuk22 = bavapi.brandscape_data("TOKEN", year_numbers=2022, country_code="GB", audiences=1)\n\nall_adults = bavapi.audiences("TOKEN", name="All Adults")\n')),(0,r.kt)("admonition",{title:"Want to use other endpoints?",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"The BAV API is very extensive, so not all endpoints are fully implemented yet."),(0,r.kt)("p",{parentName:"admonition"},"To query unsupported endpoints see the ",(0,r.kt)("a",{parentName:"p",href:"advanced-usage#other-endpoints"},"Other endpoints")," section in Advanced Usage.")),(0,r.kt)("h2",{id:"bavapi-query-parameters"},(0,r.kt)("inlineCode",{parentName:"h2"},"bavapi")," query parameters"),(0,r.kt)("p",null,"In order to validate the request parameters before sending a bad request, ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," will automatically check that the\nparameters from your query and filters are of the type expected by the Fount API. If any parameter doesn't conform to\nthe API requirements, ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," will raise a ",(0,r.kt)("inlineCode",{parentName:"p"},"ValidationError"),"."),(0,r.kt)("admonition",{title:"What it's doing",type:"note"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," performs an initial request to make sure the query parameters are valid, and to retrieve information about the\nnumber of pages it will need to fetch."),(0,r.kt)("p",{parentName:"admonition"},"If the initial request fails, ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," will not perform more requests."),(0,r.kt)("p",{parentName:"admonition"},"Similarly, if the initial request returns the entirety of the query (e.g., there are only 10 results and ",(0,r.kt)("inlineCode",{parentName:"p"},"per_page")," is\nabove 10, which it is by default), no further requests will be performed, and instead the data from the initial response\nwill be returned.")),(0,r.kt)("h3",{id:"filters"},"Filters"),(0,r.kt)("p",null,"Each endpoint has a filter class associated with it, as each endpoint has its own filter requirements:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Endpoint"),(0,r.kt)("th",{parentName:"tr",align:null},"Filters class"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'"audiences"')),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"AudiencesFilters"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'"brand-metrics"')),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"BrandMetricsFilters"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'"brand-metric-groups"')),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"BrandMetricGroupsFilters"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'"brands"')),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"BrandsFilters"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'"brandscape-data"')),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"BrandscapeFilters"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'"categories"')),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"CategoriesFilters"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'"collections"')),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"CollectionsFilters"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'"companies"')),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"CompaniesFilters"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'"sectors"')),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"SectorsFilters"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'"studies"')),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"StudiesFilters"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'"years"')),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"YearsFilters"))))),(0,r.kt)("p",null,"These filters are available under the ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi.filters")," namespace."),(0,r.kt)("admonition",{title:"Don't mix and match filters",type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Using a filters class not meant for a specific endpoint won't raise any errors from the outset, but it also won't\nprovide IDE type support or type validation to the parameters that are associated with each endpoint."),(0,r.kt)("p",{parentName:"admonition"},"Similarly, using a dictionary (as seen in the example below) won't provide validation or type hints. Use the dictionary\nmethod with caution.")),(0,r.kt)("p",null,"Some of the more common filters for each endpoint have been added directly to the ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," functions. More info in the\n",(0,r.kt)("a",{parentName:"p",href:"./endpoints/"},"endpoints")," section."),(0,r.kt)("admonition",{title:"Example",type:"info"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("inlineCode",{parentName:"p"},"bavapi.brands")," has parameters such as ",(0,r.kt)("inlineCode",{parentName:"p"},"name"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"country_codes"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"year_numbers"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"brand_id")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"studies"),", which you can\nuse directly from the function without creating a filters instance.")),(0,r.kt)("p",null,"However, less commonly used filters, as well as ",(0,r.kt)("a",{parentName:"p",href:"#value-filters"},"value filters")," must be specified by using the ",(0,r.kt)("inlineCode",{parentName:"p"},"filters"),"\nparameters in each function."),(0,r.kt)("p",null,"Filters can be specified using a python dictionary (if you know the name of the filters you need), or directly creating\na filter instance."),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"filters",label:"Filters instance (recommended)",default:!0,mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'result = bavapi.brands(\n    filters=bavapi.filters.BrandsFilters(name="Swatch", country_codes=["US", "UK"])\n)\n'))),(0,r.kt)(l.Z,{value:"dict",label:"Dictionary",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'result = bavapi.brands(\n    filters={"name":"Swatch", "country_codes":["US", "UK"]}\n)\n')))),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"If both regular function parameters and filters are specified, the values in the filters parameter will take precedence\nfor the actual request:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-py"},'result = bavapi.brands(name="Swatch", filters={"name": "Facebook"})\n')),(0,r.kt)("p",{parentName:"admonition"},"The request will use ",(0,r.kt)("inlineCode",{parentName:"p"},'name="Facebook"'),", because values specified in the ",(0,r.kt)("inlineCode",{parentName:"p"},"filters")," parameter take precedence.")),(0,r.kt)("h3",{id:"value-filters"},"Value filters"),(0,r.kt)("p",null,'"Value" filters refer to filtering on the values of the data returned by the endpoint. For example, filtering by\ncategory name or by sector.'),(0,r.kt)("p",null,"These value filters ",(0,r.kt)("strong",{parentName:"p"},"must")," be specified in the ",(0,r.kt)("inlineCode",{parentName:"p"},"filters")," parameter. If they are added to the function call as regular\nkeyworrd arguments, a ",(0,r.kt)("inlineCode",{parentName:"p"},"ValidationError")," will be raised."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'bavapi.brands(name="Swatch", filters={"sector_name": "Watches"})  # ok\n\nbavapi.brands(name="Swatch", sector_name="Watches")  # raises ValidationError\n')),(0,r.kt)("p",null,"When using additional value filters, which might not be available in the arguments to the function call, it is\nrecommended to use the ",(0,r.kt)("inlineCode",{parentName:"p"},"filters")," parameter instead of mixing function parameters and Filters parameters:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'bavapi.brands(filters=bavapi.filters.BrandsFilters(name="Swatch", sector_name="Watches"))\n')),(0,r.kt)("h3",{id:"fields"},"Fields"),(0,r.kt)("p",null,"It is possible to ",(0,r.kt)("a",{parentName:"p",href:"/docs/2.x/customizing/fields"},"specify which fields")," a response should contain. If so, the API will ",(0,r.kt)("strong",{parentName:"p"},"only"),"\nreturn those fields."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'result = bavapi.brands(name="Swatch", fields=["id", "name"])\nresult.columns  # will only have ["id", "name"] as columns\n')),(0,r.kt)("h3",{id:"sort"},"Sort"),(0,r.kt)("p",null,"It is possible to ",(0,r.kt)("a",{parentName:"p",href:"/docs/2.x/customizing/filters#sorting-results"},"sort the data")," by a column from the response."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'# sorted by name\nresult = bavapi.brands(name="Swatch", sort="name")\n\n# descending sorted by name (note the \'-\')\nresult = bavapi.brands(name="Swatch", sort="-name")\n')),(0,r.kt)("p",null,"Responses are sorted by item id, in ascending order, by default."),(0,r.kt)("h3",{id:"includes"},"Includes"),(0,r.kt)("p",null,"Aside from the data directly available for each of the resources in the Fount, these resources can also be connected\nacross endpoints."),(0,r.kt)("p",null,"Each endpoint supports different ",(0,r.kt)("a",{parentName:"p",href:"/docs/2.x/customizing/includes"},"included fields"),". Please read the\n",(0,r.kt)("a",{parentName:"p",href:"/docs/2.x/intro"},"API documentation")," for more info on the specific set of includes supported by each endpoint."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'# will include info about the brand\'s company\nresult = bavapi.brands(name="Swatch", includes="company")\n')),(0,r.kt)("admonition",{title:"Default Includes",type:"note"},(0,r.kt)("p",{parentName:"admonition"},"The ",(0,r.kt)("inlineCode",{parentName:"p"},"brandscape_data")," function includes ",(0,r.kt)("inlineCode",{parentName:"p"},"study"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"brand"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"category")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"audience")," by default.")),(0,r.kt)("h3",{id:"pagination"},"Pagination"),(0,r.kt)("p",null,"All requests to the Fount are ",(0,r.kt)("a",{parentName:"p",href:"/docs/2.x/pagination"},"paginated"),", meaning that one must request and receive from the server\none page at a time. The SDK automatically combines all responses into one data table for convenience."),(0,r.kt)("p",null,"Pagination is controlled by three parameters:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"page")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"per_page")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"max_pages"))),(0,r.kt)("p",null,"If only ",(0,r.kt)("inlineCode",{parentName:"p"},"page")," is set to an integer greater than ",(0,r.kt)("inlineCode",{parentName:"p"},"0"),", that single page will be requested."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},"bavapi.studies(page=1)  # Will request a single page of data\n")),(0,r.kt)("p",null,"If either ",(0,r.kt)("inlineCode",{parentName:"p"},"per_page")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"max_pages")," are set, ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," will request the appropriate pages from the Fount API."),(0,r.kt)("p",null,"While the Fount API default is ",(0,r.kt)("inlineCode",{parentName:"p"},"25"),", the default ",(0,r.kt)("inlineCode",{parentName:"p"},"per_page")," set by ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," is ",(0,r.kt)("inlineCode",{parentName:"p"},"100"),"."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"The maximum number of elements per page allowed by the Fount API is ",(0,r.kt)("inlineCode",{parentName:"p"},"1000"),".")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," will calculate the number of pages from the total items reported by the Fount."),(0,r.kt)("p",null,"It is also possible to set the number of ",(0,r.kt)("inlineCode",{parentName:"p"},"max_pages"),", which will limit the number of pages requested regardless of the\nreported total."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"page")," value will be used as the starting page for the request. Therefore, if ",(0,r.kt)("inlineCode",{parentName:"p"},"page=10")," and, for example,\n",(0,r.kt)("inlineCode",{parentName:"p"},"max_pages=30"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," will request pages ",(0,r.kt)("inlineCode",{parentName:"p"},"10")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"40"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'# Request pages with 50 items per page\n# up to pages calculated from total reported\nbavapi.studies("TOKEN", per_page=50)\n\n# Request pages with 100 items (default) per page up to 10 pages\n# or pages calculated from total reported, whichever is smaller\nbavapi.studies("TOKEN", max_pages=10)\n\n# Request pages with 10 items per page up to 100 pages\n# or pages calculated from total reported, whichever is smaller\nbavapi.studies("TOKEN", per_page=10, max_pages=100)\n\n# Request pages with 100 items (default) per page from page 3 to 33\n# or pages calculated from total reported, whichever is smaller\nbavapi.studies("TOKEN", page=3, max_pages=30)\n')),(0,r.kt)("h3",{id:"metric-and-metric-group-keys"},"Metric and metric group keys"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"metric_keys")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"metric_group_keys")," are special filters to specify the data ",(0,r.kt)("em",{parentName:"p"},"columns")," that the response should\ncontain."),(0,r.kt)("p",null,"The API response will include all score types for that metric or metric group."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Currently, only the ",(0,r.kt)("inlineCode",{parentName:"p"},"brandscape-data")," endpoint supports the use of metric and metric group keys. All other endpoints\nwill ignore this parameter. More info in the\n",(0,r.kt)("a",{parentName:"p",href:"/docs/2.x/developer-tools/python/endpoints/brandscape-data#metric-and-metric-group-keys"},(0,r.kt)("inlineCode",{parentName:"a"},"brandscape-data"))," endpoint section.")),(0,r.kt)("h2",{id:"using-query-objects"},"Using ",(0,r.kt)("inlineCode",{parentName:"h2"},"Query")," objects"),(0,r.kt)("p",null,"While the available parameters in endpoint functions and methods are provided for convenience, it is possible to use\n",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi.Query")," objects directly inside function calls."),(0,r.kt)("p",null,"Similarly to filters objects, when using ",(0,r.kt)("inlineCode",{parentName:"p"},"Query")," in one of the endpoint methods, the parameter values specified in the\n",(0,r.kt)("inlineCode",{parentName:"p"},"Query")," object will take precedence over parameters specified at the function level."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'# will use `name="Facebook"` because `query` values take precedence.\nbavapi.brands(name="Swatch", query=bavapi.Query(filters={"name":"Facebook"}))\n')),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Read more about ",(0,r.kt)("inlineCode",{parentName:"p"},"Query")," in the ",(0,r.kt)("a",{parentName:"p",href:"./advanced-usage#the-query-class"},"Advanced usage")," section.")),(0,r.kt)("h2",{id:"formatting-output"},"Formatting output"),(0,r.kt)("p",null,"It is possible that some of the data retrieved from the Fount includes multiple items."),(0,r.kt)("admonition",{title:"Example",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"For example, requesting the ",(0,r.kt)("inlineCode",{parentName:"p"},"studies")," include in ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi.brands")," will return a column containing lists of dictionaries\nwith study info for all studies that a brand appears in."),(0,r.kt)("table",{parentName:"admonition"},(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"right"}),(0,r.kt)("th",{parentName:"tr",align:"right"},"id"),(0,r.kt)("th",{parentName:"tr",align:"left"},"name"),(0,r.kt)("th",{parentName:"tr",align:"left"},"studies"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"0"),(0,r.kt)("td",{parentName:"tr",align:"right"},"24353"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Facebook"),(0,r.kt)("td",{parentName:"tr",align:"left"},"[{'id': 254, 'name': 'Argentina ...")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"..."),(0,r.kt)("td",{parentName:"tr",align:"right"},"..."),(0,r.kt)("td",{parentName:"tr",align:"left"},"..."),(0,r.kt)("td",{parentName:"tr",align:"left"},"..."))))),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," provides a ",(0,r.kt)("inlineCode",{parentName:"p"},"stack_data")," parameter to its functions and methods that will take those lists of dictionaries and\ngenerate a new entry (row) in the resulting DataFrame for each element in the list."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'bavapi.brands("Facebook", include="studies", stack_data=True)\n')),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"right"}),(0,r.kt)("th",{parentName:"tr",align:"right"},"id"),(0,r.kt)("th",{parentName:"tr",align:"left"},"name"),(0,r.kt)("th",{parentName:"tr",align:"right"},"studies_id"),(0,r.kt)("th",{parentName:"tr",align:"left"},"studies_name"),(0,r.kt)("th",{parentName:"tr",align:null},"..."))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"0"),(0,r.kt)("td",{parentName:"tr",align:"right"},"24353"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Facebook"),(0,r.kt)("td",{parentName:"tr",align:"right"},"254"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Argentina - Adults 2011"),(0,r.kt)("td",{parentName:"tr",align:null},"...")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"1"),(0,r.kt)("td",{parentName:"tr",align:"right"},"24353"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Facebook"),(0,r.kt)("td",{parentName:"tr",align:"right"},"787"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Argentina - Adults 2012"),(0,r.kt)("td",{parentName:"tr",align:null},"...")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"..."),(0,r.kt)("td",{parentName:"tr",align:"right"},"..."),(0,r.kt)("td",{parentName:"tr",align:"left"},"..."),(0,r.kt)("td",{parentName:"tr",align:"right"},"..."),(0,r.kt)("td",{parentName:"tr",align:"left"},"..."),(0,r.kt)("td",{parentName:"tr",align:null},"...")))),(0,r.kt)("h2",{id:"suppressing-progress-bars"},"Suppressing progress bars"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," displays progress bars to show download progress. Each tick in the progress bar refers to individual pages\nbeing downloaded."),(0,r.kt)("p",null,"It's possible to supress progress bar outputs via the ",(0,r.kt)("inlineCode",{parentName:"p"},"verbose")," parameter in function calls and ",(0,r.kt)("inlineCode",{parentName:"p"},"Client")," init methods:"),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"sync",label:"Sync (Won't show progress bar)",default:!0,mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'bavapi.brands(TOKEN, "Facebook", verbose=False)\n'))),(0,r.kt)(l.Z,{value:"async",label:"Async (Won't show progress bar)",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'async with bavapi.Client(TOKEN, verbose=False) as bav:\n    await bav.brands("Facebook")\n')))),(0,r.kt)("h2",{id:"timeout"},"Timeout"),(0,r.kt)("p",null,"By default, API requests will timeout after 30 seconds in order to avoid hangups."),(0,r.kt)("p",null,"This may happen more commonly when performing requests with more than 50-100 pages. If you get a ",(0,r.kt)("inlineCode",{parentName:"p"},"TimeoutError"),", you\ncan change this parameter to allow for longer timeouts."),(0,r.kt)("p",null,"It is possible to set the time before timeout when performing requests with ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi"),":"),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"sync",label:"Sync",default:!0,mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'bavapi.brands(TOKEN, "Facebook", timeout=60)\n'))),(0,r.kt)(l.Z,{value:"async",label:"Async",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'async with bavapi.Client(TOKEN, timeout=60) as bav:\n    await bav.brands("Facebook")\n')))),(0,r.kt)("h2",{id:"error-handling"},"Error handling"),(0,r.kt)("h3",{id:"warn-or-raise-when-a-page-fails-to-download"},"Warn or raise when a page fails to download"),(0,r.kt)("p",null,"You can control the error handling behavior of ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," by changing the ",(0,r.kt)("inlineCode",{parentName:"p"},"on_errors")," parameter in top-level functions\nand the ",(0,r.kt)("inlineCode",{parentName:"p"},"Client")," interface."),(0,r.kt)("p",null,"Options and examples:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'"warn"')," (default): Will return all successfully downloaded data, and warn at the end about any pages that failed"),(0,r.kt)("li",{parentName:"ul"},"downloading so they can be manually retried."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'"raise"'),": Will raise any exception that occurs immediately. This was the default behavior until ",(0,r.kt)("inlineCode",{parentName:"li"},"v0.13"),".")),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"warn",label:"Warn",default:!0,mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'>>> bavapi.brands("TOKEN", "Facebook", verbose=False, on_errors="warn") # Fails page 1\nUserWarning: Could not fetch pages: ["page 1: Exception(...)"]  # Does not raise\n'))),(0,r.kt)(l.Z,{value:"raise",label:"Raise",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'>>> bavapi.brands("TOKEN", "Facebook", verbose=False, on_errors="raise") # Fails page 1\nException: ...  # Raised\n')))),(0,r.kt)("admonition",{title:'"Some requests may still raise"',type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"During the initial handshake between ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," and the Fount API, only SSL errors are retried. Therefore, some queries\nmay still raise exceptions even if ",(0,r.kt)("inlineCode",{parentName:"p"},"on_errors")," is set to ",(0,r.kt)("inlineCode",{parentName:"p"},'"warn"'),":"),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Invalid parameters will raise a ",(0,r.kt)("inlineCode",{parentName:"li"},"ValidationError")," if they are not of the correct Python type"),(0,r.kt)("li",{parentName:"ul"},"Server errors will raise an ",(0,r.kt)("inlineCode",{parentName:"li"},"APIError")," with additional details about the issue"),(0,r.kt)("li",{parentName:"ul"},"Queries with no results found will raise a ",(0,r.kt)("inlineCode",{parentName:"li"},"DataNotFoundError")),(0,r.kt)("li",{parentName:"ul"},"Requests which exceed the user's rate limit will raise a ",(0,r.kt)("inlineCode",{parentName:"li"},"RateLimitExceededError")))),(0,r.kt)("h3",{id:"retry-failed-requests"},"Retry failed requests"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," will automatically retry requests that fail because of an exception. The number of retry attempts can be\ncontrolled via the ",(0,r.kt)("inlineCode",{parentName:"p"},"retries")," parameter in top-level functions and the ",(0,r.kt)("inlineCode",{parentName:"p"},"Client")," interface:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'bavapi.brands("TOKEN", retries=5)  # Will retry pages 5 times after original failure\n')),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"There are some additional, advanced options for controlling the behavior of ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," requests. More info in the\n",(0,r.kt)("a",{parentName:"p",href:"advanced-usage#control-bavapi-batching-behavior"},"Control ",(0,r.kt)("inlineCode",{parentName:"a"},"bavapi")," batching behavior")," section from the Advanced Usage documentation.")))}k.isMDXComponent=!0}}]);