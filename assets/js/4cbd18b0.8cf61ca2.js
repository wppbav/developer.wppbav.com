"use strict";(self.webpackChunkthe_fount=self.webpackChunkthe_fount||[]).push([[4486],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=p(n),m=r,h=d["".concat(s,".").concat(m)]||d[m]||c[m]||i;return n?a.createElement(h,o(o({ref:t},u),{},{components:n})):a.createElement(h,o({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8949:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(7294),r=n(6010);const i={tabItem:"tabItem_Ymn6"};function o(e){let{children:t,hidden:n,className:o}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(i.tabItem,o),hidden:n},t)}},4866:(e,t,n)=>{n.d(t,{Z:()=>g});var a=n(7462),r=n(7294),i=n(6010),o=n(2466),l=n(6550),s=n(1980),p=n(7392),u=n(12);function d(e){return function(e){return r.Children.map(e,(e=>{if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}function c(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??d(n);return function(e){const t=(0,p.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function m(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function h(e){let{queryString:t=!1,groupId:n}=e;const a=(0,l.k6)(),i=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,s._X)(i),(0,r.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(a.location.search);t.set(i,e),a.replace({...a.location,search:t.toString()})}),[i,a])]}function f(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,i=c(e),[o,l]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:i}))),[s,p]=h({queryString:n,groupId:a}),[d,f]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,i]=(0,u.Nk)(n);return[a,(0,r.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:a}),b=(()=>{const e=s??d;return m({value:e,tabValues:i})?e:null})();(0,r.useLayoutEffect)((()=>{b&&l(b)}),[b]);return{selectedValue:o,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);l(e),p(e),f(e)}),[p,f,i]),tabValues:i}}var b=n(2389);const k={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function y(e){let{className:t,block:n,selectedValue:l,selectValue:s,tabValues:p}=e;const u=[],{blockElementScrollPositionUntilNextRender:d}=(0,o.o5)(),c=e=>{const t=e.currentTarget,n=u.indexOf(t),a=p[n].value;a!==l&&(d(t),s(a))},m=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const n=u.indexOf(e.currentTarget)+1;t=u[n]??u[0];break}case"ArrowLeft":{const n=u.indexOf(e.currentTarget)-1;t=u[n]??u[u.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":n},t)},p.map((e=>{let{value:t,label:n,attributes:o}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:l===t?0:-1,"aria-selected":l===t,key:t,ref:e=>u.push(e),onKeyDown:m,onClick:c},o,{className:(0,i.Z)("tabs__item",k.tabItem,o?.className,{"tabs__item--active":l===t})}),n??t)})))}function v(e){let{lazy:t,children:n,selectedValue:a}=e;if(n=Array.isArray(n)?n:[n],t){const e=n.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},n.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function N(e){const t=f(e);return r.createElement("div",{className:(0,i.Z)("tabs-container",k.tabList)},r.createElement(y,(0,a.Z)({},e,t)),r.createElement(v,(0,a.Z)({},e,t)))}function g(e){const t=(0,b.Z)();return r.createElement(N,(0,a.Z)({key:String(t)},e))}},3779:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>p,toc:()=>d});var a=n(7462),r=(n(7294),n(3905)),i=n(4866),o=n(8949);const l={sidebar_label:"Advanced Usage"},s="Advanced Usage",p={unversionedId:"developer-tools/python/advanced-usage",id:"developer-tools/python/advanced-usage",title:"Advanced Usage",description:"This section is intended for developers who are interested in embedding bavapi functionality into their APIs and",source:"@site/docs/developer-tools/python/advanced-usage.md",sourceDirName:"developer-tools/python",slug:"/developer-tools/python/advanced-usage",permalink:"/docs/2.x/developer-tools/python/advanced-usage",draft:!1,editUrl:"https://github.com/wppbav/developer.wppbav.com/edit/main/docs/developer-tools/python/advanced-usage.md",tags:[],version:"current",frontMatter:{sidebar_label:"Advanced Usage"},sidebar:"toolsSidebar",previous:{title:"Basic Usage",permalink:"/docs/2.x/developer-tools/python/basic-usage"},next:{title:"Overview",permalink:"/docs/2.x/developer-tools/python/endpoints/"}},u={},d=[{value:"The <code>Client</code> interface",id:"the-client-interface",level:2},{value:"Using the <code>Client</code> interface",id:"using-the-client-interface",level:2},{value:"Other endpoints",id:"other-endpoints",level:2},{value:"The <code>Query</code> class",id:"the-query-class",level:2},{value:"<code>Query</code> parameters",id:"query-parameters",level:3},{value:"Raw parameter dictionary",id:"raw-parameter-dictionary",level:3},{value:"Control <code>bavapi</code> batching behavior",id:"control-bavapi-batching-behavior",level:2},{value:"User Agent",id:"user-agent",level:2}],c={toc:d},m="wrapper";function h(e){let{components:t,...n}=e;return(0,r.kt)(m,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"advanced-usage"},"Advanced Usage"),(0,r.kt)("p",null,"This section is intended for developers who are interested in embedding ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," functionality into their APIs and\napplications."),(0,r.kt)("admonition",{title:"Async Support",type:"info"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," natively supports asynchronous execution, so it is ready to work with popular ",(0,r.kt)("inlineCode",{parentName:"p"},"async")," libraries such as\n",(0,r.kt)("a",{parentName:"p",href:"https://fastapi.tiangolo.com/"},(0,r.kt)("inlineCode",{parentName:"a"},"fastapi")),".")),(0,r.kt)("h2",{id:"the-client-interface"},"The ",(0,r.kt)("inlineCode",{parentName:"h2"},"Client")," interface"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"Client")," class is the backbone of ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi"),", and it is the recommended way to interact with the API for more\nadvanced users."),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"If you're familiar with the ",(0,r.kt)("inlineCode",{parentName:"p"},"requests")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"httpx")," python packages, this is similar to using ",(0,r.kt)("inlineCode",{parentName:"p"},"requests.Session()")," or\n",(0,r.kt)("inlineCode",{parentName:"p"},"httpx.Client()"),".")),(0,r.kt)("p",null,"Using the ",(0,r.kt)("inlineCode",{parentName:"p"},"Client")," class instead of the top-level endpoint functions (",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi.brands"),", for example), can bring\nsignificant performance improvements, especially when performing multiple requests at the same time."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"Client")," interface is based on ",(0,r.kt)("inlineCode",{parentName:"p"},"httpx.Client"),", so it benefits from all the performance features from ",(0,r.kt)("inlineCode",{parentName:"p"},"httpx"),":"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("mdxAdmonitionTitle",{parentName:"admonition"},"Quote from the ",(0,r.kt)("inlineCode",{parentName:"mdxAdmonitionTitle"},"httpx")," ",(0,r.kt)("a",{parentName:"mdxAdmonitionTitle",href:"https://www.python-httpx.org/advanced/"},"docs")),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Reduced latency across requests (no handshaking)."),(0,r.kt)("li",{parentName:"ul"},"Reduced CPU usage and round-trips."),(0,r.kt)("li",{parentName:"ul"},"Reduced network congestion."))),(0,r.kt)("p",null,"By using ",(0,r.kt)("inlineCode",{parentName:"p"},"Client"),", you will also get all these benefits, including in Jupyter Notebooks."),(0,r.kt)("h2",{id:"using-the-client-interface"},"Using the ",(0,r.kt)("inlineCode",{parentName:"h2"},"Client")," interface"),(0,r.kt)("p",null,"It is recommended to use ",(0,r.kt)("inlineCode",{parentName:"p"},"Client")," in an ",(0,r.kt)("inlineCode",{parentName:"p"},"async with")," block:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'async with bavapi.Client("TOKEN") as bav:\n    result = await bav.brands("Swatch")\n')),(0,r.kt)("p",null,"Otherwise, it is possible to use ",(0,r.kt)("inlineCode",{parentName:"p"},"Client")," methods outside of an ",(0,r.kt)("inlineCode",{parentName:"p"},"async with")," block, but it might be slightly less\nperformant."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'bav = bavapi.Client("TOKEN")\nresult = await bav.brands("Swatch")\nawait bav.aclose()  # Close the connection after you\'re done making requests\n')),(0,r.kt)("h2",{id:"other-endpoints"},"Other endpoints"),(0,r.kt)("p",null,"Because of the large number of available endpoints in the Fount and the highly customizable queries, some endpoints\nwon't have extended support from the start."),(0,r.kt)("admonition",{title:"Open for feedback",type:"note"},(0,r.kt)("p",{parentName:"admonition"},"If you would like to see new endpoints with full type annotations and validation support, please open an\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/wppbav/bavapi-sdk-python/issues"},"issue"),' on GitHub with the "Feature Request" template.')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," provides ",(0,r.kt)("inlineCode",{parentName:"p"},"raw_query")," functions/methods to access all the available endpoints without existing endpoint\nfunctions/methods:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"bavapi.raw_query")," for synchronous requests."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"bavapi.Client.raw_query")," for asynchronous requests.")),(0,r.kt)("p",null,"These ",(0,r.kt)("inlineCode",{parentName:"p"},"raw_query")," methods require the use of ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi.Query")," instances to make the request:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'async with bavapi.Client("TOKEN") as bav:\n    res = await bav.raw_query(\n        "companies",\n        bavapi.Query(filters=bavapi.filters.FountFilters(name="Apple"))\n    )\n')),(0,r.kt)("p",null,"These functions will return a list of JSON dictionaries, one for each entry retrieved from the Fount:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'[\n    {"name": "Apple", "id": 1},\n    {"name": "Applebee\'s", "id": 2},\n    // ...\n]\n')),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"These methods are meant to be used for custom processing of data (not resulting in a ",(0,r.kt)("inlineCode",{parentName:"p"},"pandas")," DataFrame), but it is\nalso possible to use some of the parsing functions available in ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapising.responses"),".")),(0,r.kt)("h2",{id:"the-query-class"},"The ",(0,r.kt)("inlineCode",{parentName:"h2"},"Query")," class"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"bavapi.Query")," is a ",(0,r.kt)("inlineCode",{parentName:"p"},"pydantic"),"-powered class that holds and validates all the common (aside from\nendpoint-specific filters) query parameters to pass to the Fount API."),(0,r.kt)("p",null,"The default values for the class are the same as the default values in the Fount API itself, so an empty ",(0,r.kt)("inlineCode",{parentName:"p"},"Query"),"\nobject can be used to get all entries for a specific endpoint:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'query = bavapi.Query()\n\nasync with bavapi.Client("TOKEN") as bav:\n    # Returns all entries for `brand-metrics`. Similar to making a `GET` request with no parameters.\n    res = await bav.raw_query("brand-metrics", query)\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Query")," can be used to set limits on the number of pages retrieved, or to request a specific page from a query:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},"bavapi.Query(\n    per_page = 200,\n    max_pages = 50,\n    ...  # Other params\n)\n")),(0,r.kt)("h3",{id:"query-parameters"},(0,r.kt)("inlineCode",{parentName:"h3"},"Query")," parameters"),(0,r.kt)("p",null,"All Fount queries performed with ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi.Query")," support the following parameters:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"id"),": Return only results for a specific id."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"page"),": The page number of results to return."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"per_page"),": The number of results to return per page. Default is 25 and maximum is 100."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"max_pages"),": The maximum number of pages to request. Defaults to requesting all pages in a query."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fields"),": The keys for the fields to include in the response. Usually they are the field name in lower case."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"sort"),": The key(s) for the field(s) to order the response results by."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"include"),": Additional linked resources to include in the response."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"updated_since"),": Only return items that have been updated since this timestamp.")),(0,r.kt)("p",null,"For more information on the behavior of each of these parameters, see the ",(0,r.kt)("a",{parentName:"p",href:"/docs/2.x/customizing/fields"},"customizing fields"),"\nsection."),(0,r.kt)("h3",{id:"raw-parameter-dictionary"},"Raw parameter dictionary"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"to_params")," method can be used to parse the parameters into a dictionary of what will be sent to the Fount API:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'>>> bavapi.Query(\n...     filters=BrandscapeFilters(\n...         brand_name="Facebook",\n...         year_numbers=[2012, 2013, 2014, 2015]\n...     ),\n...     include=["company"]\n... ).to_params(endpoint="brandscape-data")  # (1)\n{\n    "include[brandscape-data]": "company",  # (2)\n    "filter[brand_name]": "Facebook",\n    "year_numbers": "2012,2013,2014,2015",\n}\n')),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Needs the endpoint name to format parameters correctly."),(0,r.kt)("li",{parentName:"ol"},"Parses ",(0,r.kt)("inlineCode",{parentName:"li"},"filters")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"include")," into the correct format for the Fount API, and parses all elements in lists of\nparameters to their string representation.")),(0,r.kt)("h2",{id:"control-bavapi-batching-behavior"},"Control ",(0,r.kt)("inlineCode",{parentName:"h2"},"bavapi")," batching behavior"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," will automatically batch paginated requests to the API to improve latency and throughput. Default values are\nset to maintain around twenty concurrent requests at a time."),(0,r.kt)("p",null,"In addition, ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," will also automatically retry failed requests a number of times (default ",(0,r.kt)("inlineCode",{parentName:"p"},"2"),"), which can be\ndefined by the user."),(0,r.kt)("p",null,"Both top-level functions and the ",(0,r.kt)("inlineCode",{parentName:"p"},"Client")," class have the following parameters to control the behavior of the requests:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"batch_size"),": Number of pages to include in each batch of requests, default ",(0,r.kt)("inlineCode",{parentName:"li"},"10"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"n_workers"),": Number of worker coroutines that will make batched requests at once, default ",(0,r.kt)("inlineCode",{parentName:"li"},"2"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"retries"),": Number of times to retry a page request before raising an exception, default ",(0,r.kt)("inlineCode",{parentName:"li"},"3"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"on_errors"),": Whether to ",(0,r.kt)("inlineCode",{parentName:"li"},'"warn"')," about failed requests at the end of the query, or ",(0,r.kt)("inlineCode",{parentName:"li"},'"raise"')," immediately upon failure\n(after retries), default ",(0,r.kt)("inlineCode",{parentName:"li"},'"warn"'),".")),(0,r.kt)("p",null,"These parameters can be set in both top-level functions and the async ",(0,r.kt)("inlineCode",{parentName:"p"},"Client")," class:"),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"sync",label:"Sync",default:!0,mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'bavapi.brands(\n    TOKEN,\n    batch_size=5,  # number of requests per batch\n    n_workers=5,  # number of concurrent workers\n    retries=2,  # number of retry attempts\n    on_errors="raise",  # raise on failure after retries\n)\n'))),(0,r.kt)(o.Z,{value:"async",label:"Async",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'async with bavapi.Client(\n    TOKEN,\n    batch_size=5,  # number of requests per batch\n    n_workers=5,  # number of concurrent workers\n    retries=2,  # number of retry attempts\n    on_errors="raise",  # raise on failure after retries\n) as client:\n    await client.brands()\n')))),(0,r.kt)("p",null,"The query from the examples above will result in ",(0,r.kt)("em",{parentName:"p"},"25")," concurrent API requests (5 ",(0,r.kt)("inlineCode",{parentName:"p"},"batch_size")," ",(0,r.kt)("em",{parentName:"p"}," 5 ",(0,r.kt)("inlineCode",{parentName:"em"},"n_workers"),"), and\n",(0,r.kt)("inlineCode",{parentName:"em"},"bavapi")," will retry each failed request "),"twice* (after the initial request). ",(0,r.kt)("inlineCode",{parentName:"p"},'on_errors="raise"')," will ensure that an\nexception is raised if all retries for any page result in exceptions."),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"In order to avoid SSL and timeout issues, it is recommended to set ",(0,r.kt)("inlineCode",{parentName:"p"},"batch_size")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"n_workers")," so ",(0,r.kt)("inlineCode",{parentName:"p"},"bavapi")," will\nperform at most 20-30 concurrent requests. The default is 20 concurrent requests (10 ",(0,r.kt)("inlineCode",{parentName:"p"},"batch_size")," * 2 ",(0,r.kt)("inlineCode",{parentName:"p"},"n_workers"),").")),(0,r.kt)("h2",{id:"user-agent"},"User Agent"),(0,r.kt)("p",null,"It is possible to set the ",(0,r.kt)("inlineCode",{parentName:"p"},"User Agent")," parameter for HTTP requests."),(0,r.kt)("p",null,"The default user agent is ",(0,r.kt)("inlineCode",{parentName:"p"},'"BAVAPI SDK Python"'),"."),(0,r.kt)("p",null,"If you want to change the user agent for your application, you can set it when instantiating a ",(0,r.kt)("inlineCode",{parentName:"p"},"Client"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'bav = bavapi.Client(user_agent="Your User Agent")\n')))}h.isMDXComponent=!0}}]);